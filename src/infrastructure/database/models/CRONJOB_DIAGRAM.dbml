// ============================================
// DIAGRAMA DE BASE DE DATOS - CRONJOBS
// ============================================
// Este diagrama describe la tabla de cronjobs
// para gestionar tareas programadas
// 
// Visualizar en: https://dbdiagram.io

Table cron_jobs {
  id uuid [pk, note: "UUID único del registro"]
  jobUuid uuid [unique, not null, note: "UUID único del cronjob"]
  schedule string(50) [not null, note: "Expresión cron (ej: 0 0 * * *)"]
  description text [null, note: "Descripción del propósito"]
  executablePath string(255) [not null, note: "Ruta del archivo/función ejecutable"]
  isActive boolean [default: true, note: "Estado activo/pausado"]
  lastExecution datetime [null, note: "Última ejecución"]
  nextExecution datetime [null, note: "Próxima ejecución programada"]
  executionCount int [default: 0, note: "Total de ejecuciones"]
  lastError text [null, note: "Error de última ejecución fallida"]
  createdAt datetime [default: `now()`]
  updatedAt datetime [default: `now()`]
  
  Indexes {
    jobUuid [unique]
    isActive
    createdAt
  }
}

// Notas de la tabla:
// 1. jobId: Identificador único para cada cronjob (ej: "backup-database", "daily-report")
// 2. schedule: Expresión cron estándar
//    - "0 0 * * *"    = Cada día a medianoche
//    - "*/5 * * * *"  = Cada 5 minutos
//    - "0 9 * * 1"    = Cada lunes a las 9:00
//    - "0 0 1 * *"    = Primer día del mes
// 3. executablePath: Ruta al archivo o referencia a función
//    - Ejemplos: 
//      "/src/cronjobs/backup.ts"
//      "src/infrastructure/service/backupService.ts#backup()"
//      "/scripts/maintenance.js"
// 4. isActive: Permite pausar/reanudar cronjobs sin eliminarlos
// 5. executionCount: Útil para monitoreo y auditoría
// 6. lastError: Facilita debugging de problemas recurrentes

// Ejemplos de registros:
// INSERT INTO cron_jobs (jobId, schedule, description, executablePath, isActive)
// VALUES 
// ('backup-database', '0 2 * * *', 'Respaldo diario de base de datos', '/src/cronjobs/backup.ts', true),
// ('daily-report', '0 9 * * *', 'Generar reporte diario', '/src/cronjobs/reports.ts', true),
// ('weekly-cleanup', '0 8 * * 1', 'Limpiar archivos temporales', '/src/cronjobs/cleanup.ts', true),
// ('monthly-stats', '0 0 1 * *', 'Estadísticas mensuales', '/src/cronjobs/statistics.ts', true);
